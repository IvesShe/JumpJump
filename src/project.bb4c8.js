window.__require=function t(e,i,o){function c(s,a){if(!i[s]){if(!e[s]){var r=s.split("/");if(r=r[r.length-1],!e[r]){var l="function"==typeof __require&&__require;if(!a&&l)return l(r,!0);if(n)return n(r,!0);throw new Error("Cannot find module '"+s+"'")}s=r}var u=i[s]={exports:{}};e[s][0].call(u.exports,function(t){return c(e[s][1][t]||t)},u,u.exports,t,e,i,o)}return i[s].exports}for(var n="function"==typeof __require&&__require,s=0;s<o.length;s++)c(o[s]);return c}({block:[function(t,e,i){"use strict";cc._RF.push(e,"e7713a4EqpJjaxPNGlAg4+/","block"),cc.Class({extends:cc.Component,properties:{blockPlygon:cc.PolygonCollider,centerNode:cc.Node,ScoreNode:cc.Node},onLoad:function(){this.scoreFen=0},start:function(){},getDistance:function(t,e){return t.sub(e).mag()},isInBlock:function(t){var e=!1;return cc.Intersection.pointInPolygon(t,this.blockPlygon.world.points)&&(e=!0),e},getScore:function(t){var e=this.node.convertToNodeSpaceAR(t),i=this.getDistance(this.centerNode.position,e);return this.scoreFen=i>70?1:i<=70&&i>50?10:i<=50&&i>35?20:i<=35&&i>20?30:50,this.scoreFen},playAnimation:function(){this.ScoreNode.getComponent(cc.Label).string="+"+this.scoreFen,this.ScoreNode.getComponent(cc.Animation).play()}}),cc._RF.pop()},{}],defines:[function(t,e,i){"use strict";cc._RF.push(e,"5b9321CxIpHPbAi0/+4XHoa","defines"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o={testString:"defines\u5f15\u7528\u6210\u529f",gameID:"IvesShe"},c=o;i.default=c,e.exports=i.default,cc._RF.pop()},{}],gameover:[function(t,e,i){"use strict";cc._RF.push(e,"14456+p4LVNm7bQnqkRyjC+","gameover"),cc.Class({extends:cc.Component,properties:{scoreLabel:cc.Label,resetButton:cc.Button},onLoad:function(){this.resetButton.node.on("click",this.restButtonClick,this),this.callback=null},start:function(){},setScore:function(t){this.scoreLabel.string=""+t},restButtonClick:function(t){cc.director.loadScene("game")},showPanel:function(t){this.node.active=!0,cc.log("showPanel()"),t()},hide:function(){this.node.active=!1}}),cc._RF.pop()},{}],game:[function(t,e,i){"use strict";cc._RF.push(e,"92257GtZptJl6536mRltxgy","game");var o=t("./player"),c=t("./global"),n=t("./defines"),s=t("./block"),a=t("./stageManager"),r=t("./gameover");cc.Class({extends:cc.Component,properties:{player:{type:o,default:null},blocks:{type:s,default:null},stageManager:{type:a,default:null},gameoverPanel:{type:r,default:null},scoreLabel:cc.Label,failAudio:{type:cc.AudioClip,default:null}},onLoad:function(){cc.log(this.player),this.setTouchStart(),c.test(),cc.log(n.gameID),cc.director.getCollisionManager().enabled=!0,this.numScoreTotal=0,this.gameoverPanel.hide()},start:function(){},setTouchStart:function(){this.node.on(cc.Node.EventType.TOUCH_START,this.GameTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this.GameTouchEnd,this)},disableTouch:function(){this.node.targetOff(this)},GameTouchStart:function(t){this.player.readyJump()},GameTouchEnd:function(t){this.player.onJump(this.JumpFinish.bind(this))},JumpFinish:function(){var t=this.player.getWorldPlayerPos();if(this.stageManager.currBlock=this.stageManager.nextBlock,cc.log(t),this.stageManager.currBlock.isInBlock(t)|this.stageManager.currBlock.isInBlock(t+cc.v3(0,1))|this.stageManager.currBlock.isInBlock(t+cc.v3(0,-1))|this.stageManager.currBlock.isInBlock(t+cc.v3(1,0))|this.stageManager.currBlock.isInBlock(t+cc.v3(-1,0))){var e=this.stageManager.currBlock.getScore(t);this.stageManager.currBlock.playAnimation(),this.playerJumpSuccess(e)}else this.gameOver()},playerJumpSuccess:function(t){var e=this;this.numScoreTotal+=0+t,this.scoreLabel.string="SCORE: "+this.numScoreTotal,this.stageManager.MoveStage(function(){e.stageManager.addBlock()})},gameOver:function(){var t=this;this.failAudioID=cc.audioEngine.play(this.failAudio,!1,.3),this.disableTouch(),setTimeout(function(){t.gameoverPanel.setScore(t.numScoreTotal),t.gameoverPanel.showPanel(t.resetGame.bind(t))},500),cc.log("gameOver()")},resetGame:function(){}}),cc._RF.pop()},{"./block":"block","./defines":"defines","./gameover":"gameover","./global":"global","./player":"player","./stageManager":"stageManager"}],global:[function(t,e,i){"use strict";cc._RF.push(e,"4b36cmKW7pIFY5TUMfeijJa","global"),Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var o=t("./defines"),c={test:function(){cc.log("global\u5f15\u7528\u6210\u529f"),cc.log(o.testString)}},n=c;i.default=n,e.exports=i.default,cc._RF.pop()},{"./defines":"defines"}],player:[function(t,e,i){"use strict";cc._RF.push(e,"07aefIcKe1PT7rnAc7AxO6Q","player"),cc.Class({extends:cc.Component,properties:{readyJumpAudio:{type:cc.AudioClip,default:null},jumpAudio:{type:cc.AudioClip,default:null}},onLoad:function(){this.playerSprite=cc.find("rotationNode/player",this.node),this.rotateNode=cc.find("rotationNode",this.node),this.isReadyJump=!1,this.direction=1,this.power=120,this.speed=200,this.distance=0,this.proportion=.55},start:function(){},readyJump:function(){this.readyJumpAudioID=cc.audioEngine.play(this.readyJumpAudio,!1,1),this.playerSprite.runAction(cc.scaleTo(1.5,1,.5)),this.isReadyJump=!0},JumpToBlock:function(t,e){var i=this;cc.audioEngine.stop(this.readyJumpAudioID),this.jumpAudioID=cc.audioEngine.play(this.jumpAudio,!1,1),this.playerSprite.stopAllActions();var o=cc.scaleTo(1,1,1),c=cc.jumpTo(.5,t,158,1),n=cc.rotateBy(.5,360*this.direction),s=cc.callFunc(function(){i.rotateNode.angle=0,i.direction=Math.random()<.5?1:-1,i.distance=0,i.speed=200,cc.log("\u65b0\u7684direction"),e()});this.playerSprite.runAction(o),this.rotateNode.runAction(n),this.node.runAction(cc.sequence(c,s))},onJump:function(t){this.isReadyJump=!1;var e=cc.v2(this.node.x+this.distance*this.direction,this.node.y+this.distance*this.proportion);this.JumpToBlock(e,t)},getWorldPlayerPos:function(){return this.node.parent.convertToWorldSpaceAR(this.node.position)},getDirection:function(){return this.direction},update:function(t){this.isReadyJump&&(this.speed+=t*this.power,this.distance=this.speed+600*t)}}),cc._RF.pop()},{}],stageManager:[function(t,e,i){"use strict";cc._RF.push(e,"f2ce0AP3h9KEJsLnyIjmj/j","stageManager");var o=t("./player");cc.Class({extends:cc.Component,properties:{BlockManager:cc.Node,BlockList:[cc.Prefab],player:{type:o,default:null},blockTemplate:cc.Node},onLoad:function(){this.initblockPos=this.blockTemplate.position,this.currBlock=null,this.nextBlock=null,this.mixDistance=200,this.maxDistance=400,cc.log("playerLeftorigin: "+this.playerLeftorigin),cc.log("playerRightorigin: "+this.playerRightorigin),this.playerLeftorigin=this.player.getWorldPlayerPos(),this.playerRightorigin=cc.v2(),this.playerRightorigin.x=this.playerLeftorigin.x+350,this.playerRightorigin.y=this.playerLeftorigin.y,this.proportionality=.556,this.block_zorder=-1},init:function(){this.BlockManager.removeAllChildren(),this.blockTemplate.destroy();var t=cc.instantiate(this.BlockList[0]);this.BlockManager.addChild(t),t.position=this.initblockPos;var e=t.getComponent("block");this.currBlock=e,this.nextBlock=e,this.addBlock(),cc.log("stageManager init()")},addBlock:function(){var t=Math.floor(Math.random()*this.BlockList.length),e=cc.instantiate(this.BlockList[t]);this.BlockManager.addChild(e),cc.log("index: "+t),e.zIndex=this.block_zorder,this.block_zorder--;var i=e.getComponent("block"),o=this.mixDistance+Math.random()*(this.maxDistance-this.mixDistance),c=this.player.getDirection();cc.log("\u65b0\u7684\u65b9\u584adirection: "+c),cc.log("\u65b0\u7684\u65b9\u584a\u8ddd\u96e2: "+o),e.x=c>0?this.currBlock.node.x+o:this.currBlock.node.x-o,cc.log("this.currBlock.node.y: "+this.currBlock.node.y),cc.log("this.proportionality: "+this.proportionality),e.y=this.currBlock.node.y+(o+10*Math.random())*this.proportionality,this.currBlock=this.nextBlock,this.nextBlock=i},MoveStage:function(t){var e,i=this.player.getWorldPlayerPos();cc.log("getDirection() :"+this.player.getDirection()),this.player.getDirection()>0?(e=i.sub(this.playerLeftorigin),cc.log("\u821e\u53f0\u5f80\u53f3\u79fb\u52d5")):(e=i.sub(this.playerRightorigin),cc.log("\u821e\u53f0\u5f80\u5de6\u79fb\u52d5"));var o=this.node.position.sub(e),c=cc.callFunc(function(){t()}),n=cc.sequence(cc.moveTo(.4,o),c);this.node.runAction(n)},start:function(){this.init()}}),cc._RF.pop()},{"./player":"player"}],start:[function(t,e,i){"use strict";cc._RF.push(e,"6918d1G3Y9NCpa7ws+TrsE9","start"),cc.Class({extends:cc.Component,properties:{startButton:cc.Button,loadingAnimation:cc.Animation,maskNode:cc.Node,gamebgm:{type:cc.AudioClip,default:null}},onLoad:function(){this.startButton.node.on("click",this.onClick_start,this)},start:function(){},onClick_start:function(){this.maskNode.active=!0,this.loadingAnimation.play(),cc.audioEngine.play(this.gamebgm,!0,.1),cc.director.loadScene("game")}}),cc._RF.pop()},{}]},{},["block","defines","game","gameover","global","player","stageManager","start"]);